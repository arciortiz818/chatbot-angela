var abierto = false;
function chatbot_abrirChat() {
	if (!abierto) {
		abierto = true;
		var chatElement = `
		<div id="chatbot_chat" class="wcs_fixed_right">
			<div class="card chatbot_header">
				<div class="card-body">
					<div class="card-title">
						<div class="chatbot_circleGreen mt-2"></div>
						<div>
							<h5 style="color: white;">Angela</h5>
						</div>
						<div class="ml-auto mt-0" onclick="chatbot_cerrarChat();" style="cursor:pointer;">
							<span class="fa fa-close" style="font-size:24px;"></span>
						</div>
					</div>
				</div>
			</div>
			<div class="card chatbot_content">
				<div class="card-body" style="height: 100%;">
					<iframe
						frameborder="0"
						scrolling="no"
						id="chatbot_iframe"
						height="90%"
						width="100%"
						src="https://arciortiz818.github.io/chatbot-angela"
					></iframe>
				</div>
			</div>
		</div>
	`;
		$('#chatbot_cb').before(chatElement);
	} else {
		$('#chatbot_chat').addClass('wcs_fixed_right');
		$('#chatbot_chat').css('display', 'block');
	}
	$('#chatbot_cb').css('display', 'none');
}

function chatbot_cerrarChat() {
	$('#chatbot_cb').css('display', 'inline-flex');
	$('#chatbot_chat').removeClass('wcs_fixed_right');
	$('#chatbot_chat').css('display', 'none');
	// abierto = false;
}

function addStyles() {
	var css = `
		/* Boton Abrir Chat */
		#chatbot_btnAbrirChat {
			border-color: #0049aa;
			background-image: url('https://arciortiz818.github.io/chatbot-angela/images/img-angela.jpeg');
			height: 80px;
			width: 80px;
			background-repeat: no-repeat;
			background-position: center;
			background-size: cover;
			margin-left: -22px;
		}

		#chatbot_cb{
			right: 0px;
			bottom: 37%;
			position: fixed;
			background-color: #0049aa;
			width: 170px;
			border-top-left-radius: 15%;
			border-bottom-left-radius: 15%;
			color: white;
			display: -webkit-inline-box;
			display: -ms-inline-flexbox;
			display: inline-flex;
			font-family: inherit;
			font-size: inherit;
			cursor:pointer;
			height: 80px;
		}


		#chatbot_chat {
			bottom: 0px;
			position: fixed;
		}

		#chatbot_iframe {
			overflow: hidden;
			border: none;
			height: 100%;
			width: 100%;
		}

		.chatbot_header {
			background-color: #0049aa;
			color: white;
			height: 60px;
			width: 100%;
		}

		.chatbot_header > div {
			padding-top: 15px;
		}

		.chatbot_header > div > div {
			display: -webkit-box;
			display: -ms-flexbox;
			display: flex;
		}

		.chatbot_content {
			height: 90%;
			width: 100%;
		}

		.chatbot_circleGreen {
			background-color: rgb(0, 255, 0);
			border-radius: 100%;
			height: 10px;
			width: 10px;
			margin-right: 10px;
		}

		/* Media Query Alto */
		@media only screen and (min-height: 668px) {
			#chatbot_chat {
			height: 70%;
			}
		}

		@media only screen and (max-height: 667px) and (min-height: 569px) {
			#chatbot_chat {
			height: 80%;
			}
		}

		@media only screen and (max-height: 568px) and (min-height: 481px) {
			#chatbot_chat {
			height: 100%;
			}
		}

		@media only screen and (max-height: 480px)  {
			#chatbot_chat {
			height: 100%;
			}
		}

		/* Media Query Ancho */
		@media only screen and (min-width: 1367px){
			#chatbot_chat {
			width: 25%;
			right: 15px;
			}
		}

		@media only screen and (max-width: 1366px) and (min-width: 1281px) {
			#chatbot_chat {
			width: 35%;
			right: 15px;
			}
		}

		@media only screen and (max-width: 1280px) and (min-width: 1025px) {
			#chatbot_chat {
			width: 40%;
			right: 15px;
			}
		}

		@media only screen and (max-width: 1024px) and (min-width: 801px) {
			#chatbot_chat {
			width: 45%;
			right: 15px;
			}
		}

		@media only screen and (max-width: 800px) and (min-width: 769px) {
			#chatbot_chat {
			width: 50%;
			right: 15px;
			}
		}

		@media only screen and (max-width: 768px) and (min-width: 601px) {
			#chatbot_chat {
			width: 60%;
			right: 0px;
			}
		}

		@media only screen and (max-width: 600px) and (min-width: 441px) {
			#chatbot_chat {
			width: 80%;
			right: 0px;
			}
		}

		/* Celulares */
		@media only screen and (max-width: 440px) and (min-width: 376px) {
			#chatbot_chat {
			width: 100%;
			right: 0px;
			}
		}

		@media only screen and (max-width: 375px) and (min-width: 321px) {
			#chatbot_chat {
			width: 100%;
			right: 0px;
			}
		}

		@media only screen and (max-width: 320px)  {
			#chatbot_chat {
			width: 100%;
			right: 0px;
			}
		}

          `;
	var head = document.head || document.getElementsByTagName('head')[0];
	var style = document.createElement('style');

	head.appendChild(style);

	style.type = 'text/css';
	if (style.styleSheet) {
		// This is required for IE8 and below.
		style.styleSheet.cssText = css;
	} else {
		style.appendChild(document.createTextNode(css));
	}
}

function addButtonChat() {
	var div = document.createElement('div');
	var newContent = `
  <div id="chatbot_cb" onclick="chatbot_abrirChat();" class="wcs_fixed_right">
    <div>
      <button  id="chatbot_btnAbrirChat" class="rounded-circle"></button>
    </div>
    <div class="pr-1 pt-1" style="line-height: 0.6cm;">
      <span class="font-weight-bold" style="font-size: 1em;">Hola, soy </span><span class="font-weight-bold pl-2" style="font-size: 1.4em;">Angela</span>
      <br>
      <span style="font-size: 0.8em;">Â¿Te puedo ayudar?</span>

    </div>
  </div>
              `;
	div.innerHTML = newContent;
	document.body.appendChild(div);
}

addStyles();
addButtonChat();
